# Carbon 管理系统 - 项目功能文档

更新时间：2026-01-23

## 1. 项目概述

Carbon 管理系统是一个以“碳资产开发、碳资产管理、碳交易管理”为核心的后台管理系统，同时包含商城/营销/财务/内容等通用运营模块。系统采用前后端分离与微服务架构，通过网关统一对外提供 API。

## 2. 技术架构

### 2.1 前端

- 技术：Vue（`carbon_front`）
- 路由：`carbon_front/src/router`，菜单与权限按后端返回的菜单树动态过滤
- API 封装：`carbon_front/src/api/*`

### 2.2 后端

- 技术：Spring Boot + MyBatis-Plus（`carbon_back`）
- 网关：Zuul（`carbon-gate`）统一路由前缀并转发至各业务服务
- 常用基础设施：MySQL、Redis、Nacos、RocketMQ、Elasticsearch（部分模块可选）
- 区块链对接：ChainMaker（`carbon-chainmaker`）

### 2.3 网关路由前缀

- `/authCenter/**` → `carbon-auth`
- `/system/**` → `carbon-system`
- `/assets/**` → `carbon-assets`
- `/trade/**` → `carbon-trade`

对应配置：[application.yml](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_back/carbon-gate/src/main/resources/application.yml#L38-L69)

## 3. 功能模块（前端菜单/页面口径）

本节以“路由 + 页面组件”为准，按业务域分组描述功能。

### 3.1 碳资产管理

- **碳配额**
  - 列表：`/assets/quota` → [quota.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/quota.vue)
  - 详情：`/assets/quota/quotaDetail` → [quotaDetail.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/quotaDetail.vue)
- **碳信用**
  - 列表：`/assets/credit` → [credit.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/credit.vue)
  - 详情：`/assets/credit/assetDetail` → [assetDetail.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/assetDetail.vue)
  - 碳评估：`/assets/credit/CarbonAssessment` → [CarbonAssessment.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/CarbonAssessment.vue)
- **碳数据（数据源/记录）**
  - 新增：`/dataRecord/add` → [addSource.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dataSource/addSource.vue)
  - 查看：`/dataRecord/read` → [readSource.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dataSource/readSource.vue)
  - 编辑：`/dataRecord/edit` → [editSource.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dataSource/editSource.vue)

### 3.2 碳资产开发（项目开发/CCER 申请/方法学/注册表）

- **项目开发（立项/执行/进度/文档）**
  - 立项列表：`/carbon/projectCreate` → [projectDevHome.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectDevHome.vue)
  - 项目详情：`/carbon/projectDetail` → [projectDetail.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectDetail.vue)
  - 创建项目：`/carbon/projectCreate/projectAdd` → [projectAdd.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectAdd.vue)
  - 修改项目：`/carbon/projectCreate/projectEdit` → [projectEdit.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectEdit.vue)
  - 上传业主资料：`/carbon/projectCreate/ownerAdd` → [ownerAdd.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/ownerAdd.vue)
  - 开发进度：`/carbon/projectSchedule` → [projectSchedule.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectSchedule.vue)
  - 项目实施：`/carbon/projectDo` → [projectDo.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectDo.vue)
  - 项目文档：`/carbon/projectFile`、`/carbon/projectFileList` → [projectFile.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectFile.vue)、[projectFileList.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/dev/projectFileList.vue)
- **CCER 申请项目**
  - 列表：`/applyProject/` → [projectListView.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/apply/projectListView.vue)
  - 新增/查看/编辑：`/applyProject/add`、`/applyProject/read`、`/applyProject/edit` → [addNewProject.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/apply/addNewProject.vue)
- **方法学管理（业务端）**
  - 列表：`/carbon/methodology` → [method/index.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonAssets/method/index.vue)
  - 新增/查看/编辑：`/carbonMethodology/add`、`/carbonMethodology/readMethod`、`/carbonMethodology/editMethod`
- **中和资产查询**
  - 新增/查看/编辑：`/carbonAssets/add`、`/carbonAssets/read`、`/carbonAssets/edit`

### 3.3 碳交易管理与行情

- **交易账户/交易所**
  - 交易所管理：`/trade/account/exchange` → [exchangeManager.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonTrade/account/exchangeManager.vue)
  - 交易账户管理：`/trade/account/open` → [tradeAccountManager.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonTrade/account/tradeAccountManager.vue)
- **询报价管理**
  - ` /trade/offer` → [offer/index.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonTrade/offer/index.vue)
- **供需行情**
  - `/trade/quotation` → [quotation/quota.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonTrade/quotation/quota.vue)
- **行情看板**
  - `/carbonQuote/` → [quoteHome.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/quote/quoteHome.vue)

### 3.4 碳资讯/碳盘查/CRM

- **碳资讯**
  - 列表：`/carbonNewsManager/` → [carbonNews.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/news/carbonNews.vue)
  - 详情：`/newsDetail` → [newsDetail.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/news/newsDetail.vue)
- **碳盘查**
  - `/carbonCheck/`、`/carbonInventory/` → [carbonInventory/index.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/carbonInventory/index.vue)
- **碳开发客户（CRM）**
  - `/crm/carbondev` → [carbondev.vue](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/views/crm/carbondev.vue)

### 3.5 商城/运营通用模块（后台通用）

此部分为通用运营后台能力，包含商品、订单、营销、财务、内容与系统设置等。

- 商品：商品管理、分类、规格、评论、商品新增/编辑（`/carbonReduction`、`/user/*`）
- 订单：订单管理（`/order/index`）
- 营销：优惠券、秒杀、积分、砍价、拼团（`/marketing/*`）
- 财务：提现申请、充值记录、资金监控、佣金记录（`/financial/*`）
- 内容：文章管理、文章分类（`/content/*`）
- 系统设置：管理员/权限、物流、提货点、短信、客服等（`/operation/*`）
- 移动端（后台）：订单核销、订单统计与详情等（`/javaMobile/*`）

## 4. 后端服务与核心职责（微服务口径）

### 4.1 服务清单与端口（默认）

端口映射来自一键启动脚本（见 `start-all.ps1`）：

| 服务 | 端口 | 对外前缀（网关） | 职责摘要 |
|---|---:|---|---|
| carbon-auth | 9001 | `/authCenter` | 登录/注册/找回、微信登录、登录态校验 |
| carbon-system | 9002 | `/system` | 菜单/权限/角色/字典/租户、文章/资讯、审批、OSS、数据看板、CRM 记录 |
| carbon-assets | 9003 | `/assets` | 项目/方法学/注册表、碳配额/碳信用、中和资产、项目文档与监测数据 |
| carbon-trade | 9005 | `/trade` | 行情/报价、价格、合同/履约、行情 ES 检索 |
| carbon-gate | 9091 | 网关入口 | Zuul 路由转发、跨域/过滤、AI 接口 |
| carbon-mq | 9006 | 无 | RocketMQ/Canal/飞书等消息消费与异步流程 |
| carbon-chainmaker | 9007 | 未配置 | ChainMaker 链交互（上链/查询/存证等） |

### 4.2 主要 API 路径前缀

- 认证中心：`/authCenter/auth/*`、`/authCenter/check/*`、`/authCenter/weixin/*`
- 系统管理：`/system/sysMenu/*`、`/system/sysRole/*`、`/system/sysAccount/*`、`/system/sysDict/*`、`/system/sysTenant/*` 等
- 碳资产：`/assets/carbonProject/*`、`/assets/carbonMethodology/*`、`/assets/carbonMetaregistry/*`、`/assets/carbonQuotaAssets/*`、`/assets/carbonCreditAssets/*` 等
- 碳交易：`/trade/carbonTradeQuote/*`、`/trade/carbonTradePrice/*`、`/trade/carbonTradeContract/*`、`/trade/esTradeQuote/*`

后端 Controller 汇总扫描结果参考（示例入口）：[carbon-system controllers](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_back/carbon-system/src/main/java/com/carbon/system/controller/)

## 5. 权限与菜单机制（关键设计）

### 5.1 菜单来源

- 前端侧边栏菜单树由后端提供：`POST /system/sysMenu/userMenus`
- 相关实现：[SysMenuController.userMenus](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_back/carbon-system/src/main/java/com/carbon/system/controller/SysMenuController.java#L49-L56)

### 5.2 菜单与路由匹配逻辑

- 后端菜单字段 `sys_menu.menu_url`（实体字段 `menuUrl`）与前端路由 `path` 进行匹配/过滤
- 前端组装逻辑：[permission.js](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/store/modules/permission.js#L55-L103)

## 6. 本地启动与运行说明

### 6.1 一键启动

- 脚本：`start-all.ps1`
- 作用：检查依赖连通（可选）、可选 Maven 构建、启动所选后端服务、启动前端

关键参数（节选）：

- 数据源：`MySqlHost/MySqlPort/MySqlDb/MySqlUser/MySqlPassword`
- 基础设施：`RedisHost/RedisPort`、`NacosAddr`、`RocketMqNamesrv`
- 前端：`FrontendPort`、`WeChatQrUrl`
- AI：`AiBaseUrl/AiChatPath/AiApiKey/AiModel`
- 启动控制：`BackendServices`、`SkipBuild`、`SkipDependencyChecks`、`DisableLogs`

### 6.2 常用访问地址（默认）

- 前端：`http://localhost:9528/`
- 网关：`http://localhost:9091/`
- 业务服务直连（用于排障）：`http://localhost:9001/`、`9002/`、`9003/`、`9005/`

## 7. 数据与基础依赖（概览）

- **MySQL**：核心业务数据（资产/交易/系统配置等）
- **Redis**：缓存与会话/验证码等（按实现而定）
- **Nacos**：服务注册与配置中心
- **RocketMQ**：异步流程与事件驱动（`carbon-mq` 消费）
- **Elasticsearch**：方法学/注册表/行情等检索（部分服务启动时会尝试创建 index，ES 未启用会有告警但不一定影响核心 CRUD）
- **ChainMaker**：区块链存证与查询（内部服务调用为主）

## 8. 附录：碳信用列表接口示例

- 前端接口封装：[carbonAssetApi.js](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_front/src/api/carbonAssetApi.js#L542-L550)
- 后端接口入口：[CarbonCreditAssetsController](file:///d:/desktop/Carbon_manage_system/carbon_official/carbon_back/carbon-assets/src/main/java/com/carbon/assets/controller/CarbonCreditAssetsController.java)

